<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø°ÙƒÙŠ</title>
  <style>
    body {
      background-color: #000;
      color: #fff;
      font-family: 'Cairo', sans-serif;
      padding: 20px;
      text-align: center;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background-color: #111;
      padding: 20px;
      border-radius: 10px;
    }
    input, select, textarea, button {
      margin: 10px;
      padding: 10px;
      width: 90%;
      font-size: 16px;
      border-radius: 5px;
      border: none;
      background-color: #fff;
      color: #000;
    }
    button {
      background-color: #ff0055;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #ff3366;
    }
    table {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
      background-color: #222;
    }
    th, td {
      padding: 8px;
      border: 1px solid #444;
      color: #fff;
    }
    input[type="search"] {
      width: 50%;
      margin-bottom: 10px;
      background-color: #fff;
      color: #000;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>ğŸ“² Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h2>
        <h2> Ù…ÙƒÙ€Ù€ØªØ¨ Ø§Ù„ÙÙ€Ù€Ø±Ø§Øª Ù…Ø¹ÙƒÙ… Ø§ÙŠÙ†Ù…Ø§ ØªÙƒÙˆÙ†Ùˆ</h2>
    <form id="clientForm">
      <input type="text" name="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„" required><br>
      <select name="service" required>
        <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨</option>
        <option value="ÙˆØ§ØªØ³Ø§Ø¨">ÙˆØ§ØªØ³Ø§Ø¨</option>
        <option value="Ø´Ø§Ù… ÙƒØ§Ø´">Ø´Ø§Ù… ÙƒØ§Ø´</option>
        <option value="ÙÙŠØ³Ø¨ÙˆÙƒ">ÙÙŠØ³Ø¨ÙˆÙƒ</option>
        <option value="Ø§Ù†Ø³ØªØºØ±Ø§Ù…">Ø§Ù†Ø³ØªØºØ±Ø§Ù…</option>
        <option value="ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…">ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…</option>
      </select><br>
      <select name="status" required>
        <option value="">Ø­Ø§Ù„Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„</option>
        <option value="âœ… ÙˆØ§ØµÙ„">âœ… ÙˆØ§ØµÙ„</option>
        <option value="âŒ ØºÙŠØ± ÙˆØ§ØµÙ„">âŒ ØºÙŠØ± ÙˆØ§ØµÙ„</option>
      </select><br>
      <input type="text" name="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required><br>
      <textarea name="notes" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©"></textarea><br>
      <button type="submit">ğŸ’¾ ØªØ³Ø¬ÙŠÙ„</button>
    </form>

    <input type="search" id="searchInput" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù…ÙŠÙ„...">

    <table id="clientTable">
      <thead>
        <tr>
          <th>Ø§Ù„Ø§Ø³Ù…</th>
          <th>Ø¹Ø¯Ø¯ Ø§Ù„ØªÙƒØ±Ø§Ø±</th>
          <th>Ø§Ù„Ø®Ø¯Ù…Ø©</th>
          <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
          <th>Ø§Ù„Ù‡Ø§ØªÙ</th>
          <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    const form = document.getElementById("clientForm");
    const tableBody = document.querySelector("#clientTable tbody");
    const searchInput = document.getElementById("searchInput");

    const TOKEN = "7054208207:AAHVwwMlay45aLFyQn4FCJyfWM_-AoQXpMM";
    const CHAT_ID = "7493001551";

    let clients = JSON.parse(localStorage.getItem("clients")) || [];

    function saveClients() {
      localStorage.setItem("clients", JSON.stringify(clients));
    }

    function sendToTelegram(data) {
      const message = `ğŸ“¥ ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯:\nğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${data.name}\nğŸ“± Ø§Ù„Ø®Ø¯Ù…Ø©: ${data.service}\nğŸ“¶ Ø§Ù„Ø­Ø§Ù„Ø©: ${data.status}\nğŸ“ Ø§Ù„Ù‡Ø§ØªÙ: ${data.phone}\nğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${data.notes || "Ù„Ø§ ÙŠÙˆØ¬Ø¯"}`;
      fetch(`https://api.telegram.org/bot${TOKEN}/sendMessage`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ chat_id: CHAT_ID, text: message })
      });
    }

    function updateTable() {
      tableBody.innerHTML = "";
      const grouped = {};

      clients.forEach(c => {
        const key = c.name + "_" + c.phone;
        if (!grouped[key]) {
          grouped[key] = { ...c, count: 1 };
        } else {
          grouped[key].count++;
        }
      });

      Object.values(grouped).forEach(data => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${data.name}</td>
          <td>${data.count}</td>
          <td>${data.service}</td>
          <td>${data.status}</td>
          <td>${data.phone}</td>
          <td>${data.notes || "â€”"}</td>
        `;
        tableBody.appendChild(row);
      });
    }

    form.addEventListener("submit", function(e) {
      e.preventDefault();
      const data = Object.fromEntries(new FormData(form).entries());
      clients.push(data);
      saveClients();
      updateTable();
      sendToTelegram(data);
      form.reset();
    });

    searchInput.addEventListener("input", function() {
      const term = this.value.toLowerCase();
      tableBody.querySelectorAll("tr").forEach(row => {
        const match = Array.from(row.children).some(td => td.textContent.toLowerCase().includes(term));
        row.style.display = match ? "" : "none";
      });
    });

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
    updateTable();
  </script>
</body>
</html>